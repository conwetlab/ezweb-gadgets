<!-- 
* This code is licensed under terms shown on this link:
* http://forge.morfeo-project.org/wiki/index.php/Gadgets_2009_License
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link id="style" rel="StyleSheet" href="http://demo.ezweb.morfeo-project.org/repository/translator/default.css" type="text/css" />
    <script type="text/javascript" src="http://www.google.com/jsapi"></script>
    <script language="javascript" src="/ezweb/js/EzWebAPI/EzWebAPI.js"></script>
	<script type="text/javascript" language="javascript" src="/ezweb/js/lib/prototype/prototype.js"></script>
    
	<script type="text/javascript">
	
	var textS = EzWebAPI.createRGadgetVariable("inputText", setTextS);
	var textE = EzWebAPI.createRWGadgetVariable("outputText");
	var language = EzWebAPI.createRGadgetVariable("language", setLanguage);
	
	var theme = EzWebAPI.createRGadgetVariable("theme", setTheme);
	
	//Property
	var languages = EzWebAPI.createRWGadgetVariable("languages");

	var _languages = {'from':'','to':''};
	
	function setTheme(value){
		//WORKAROUND: select blue by default
		if(!value ||value =="")
			value = "blue";
		//END WA
		var href = "http://demo.ezweb.morfeo-project.org/repository/translator/css/"+value+".css";
		var sheetLink=document.getElementById('style');
		sheetLink.href=href;
		return;
	}
	
		
	function setLanguage(value)
	{
		if(languages.get()==''){
			$('srcLang').value = value;
			_languages['from'] = value;
		}
	}
	function setTextS(value)
	{
		$('original').value = value;
	}
	
	</script>
    
    
	<script type="text/javascript">
	google.load("language", "1");

	function initialize() 
	{
		var text = $('original').value;
		var srcLang = $('srcLang').value;
		var destLang = $('destLang').value;
		if (text!=""){
			google.language.translate(text, srcLang, destLang, function(result) 
			{
				var translated = document.getElementById("translation");
				if (result.translation){
					translated.value = result.translation;
					textE.set(translated.value);
					//$('translation').show();
					//guardar idioma
					_languages.from = srcLang;
					_languages.to = destLang;
					languages.set(Object.toJSON(_languages));
				}
			});
		}
		
	}

	//google.setOnLoadCallback(initialize);

    </script>
    <script type="text/javascript">
    
    function load(){
    	setTheme(theme.get());
    	$('srcLang').value = language.get();
    	//$('translation').hide();
    	googlelanguages = Object.keys(google.language.Languages).sort();
    	for(i=0;i<googlelanguages.length;i++){
    		if (google.language.isTranslatable(google.language.Languages[googlelanguages[i]])){
		       	var option = document.createElement('option');
				option.setAttribute('value', google.language.Languages[googlelanguages[i]]);

				//*****t.getLabel(google.language.Languages[googlelanguages[i]]).capitalize());********/

				option.appendChild(document.createTextNode(googlelanguages[i].capitalize()));
				$('srcLang').appendChild(option);
				
				var option = document.createElement('option');
				option.setAttribute('value', google.language.Languages[googlelanguages[i]]);
				option.appendChild(document.createTextNode(googlelanguages[i].capitalize()));
				
				$('destLang').appendChild(option);
			}
		}
		if (languages.get()!=""){
			_languages = eval('('+languages.get()+')');
			$('srcLang').value = _languages.from;
			$('destLang').value = _languages.to;
		}
    }
    function swap()
    {
    	var tmp = $('srcLang').value;
		$('srcLang').value = $('destLang').value;
		$('destLang').value = tmp;
    }
    
   /*	function generateLang(){
		t = new EzWebExt.Translator("http://demo.ezweb.morfeo-project.org/repository/translator/languages.xml", "language" , null, load);
	}*/
    
    
    
    </script>
    <!--
	 </head><body onLoad="load()">
	 <div class="full">

		<div class="text"><textarea id="original"></textarea></div>
		<div class="languages"><span class="item">From <select id="srcLang"></select></span><span class="item">To <select id="destLang"></select></span><span onClick="swap()" class="action">Swap</span>
		<input type="button" value="Translate" onClick="initialize()"/></div>
		<div class="text"><textarea id="translation"></textarea></div>
		
	 </div>
	 -->
</head><body onLoad="load()">
	 <table class="full">

		<tr><td class="text"><textarea id="original"></textarea></td></tr>
		<tr><td class="languages"><span class="item">From <select id="srcLang"></select></span><span class="item">To <select id="destLang"></select></span><span onClick="swap()" class="action">Swap</span>
		<input type="button" value="Translate" onClick="initialize()"/></td></tr>
		<tr><td class="text"><textarea id="translation"></textarea></td></tr></table>
		
	 </div>
  </body></html>