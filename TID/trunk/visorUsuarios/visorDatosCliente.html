<!-- 
* This code is licensed under terms shown on this link:
* http://forge.morfeo-project.org/wiki/index.php/Gadgets_2009_License
-->
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<script language="javascript" src="/ezweb/js/EzWebAPI/EzWebAPI.js"></script>
<title>Visor de datos de usuario</title>
<base href="http://ezweb.tid.es/repository/ezweb-gadgets/visorUsuarios/visorUsuarios_1.01/"></base>
<style type="text/css">
		body{
			margin:0px;
			padding:0px;
			background: url(background.png) repeat-x scroll left top;
			font-family:Arial,Verdana,Helvetica, Sans-Serif;
		}

		#info {
			margin:0px;
			padding:0px;
		}
	
		#div_info {
			margin:4px;
			padding:5px;
			border:2px solid #437BC8;
			background-color:white;
			-moz-border-radius:5px;
		}

		.moreInfo{
			text-decoration:underline;
		}
		
		.header{
			text-align:left;
			font-size:16px;
			font-weight:bold;	
		}
		
		td{
			font-size:12px;
			padding-left:5px;
		}
		
		#title{
			color:#000077;
			font-size:22px;
			font-weight:bold;
			margin:0px;
			padding:0px;
	}
</style>

<script>
// Events and slots
var phoneNumber = EzWebAPI.createRGadgetVariable("phoneNumber",_phoneHandler);
var address = EzWebAPI.createRWGadgetVariable("address");
var firstname = EzWebAPI.createRWGadgetVariable("firstname");
var surname = EzWebAPI.createRWGadgetVariable("surname");
var dni = EzWebAPI.createRWGadgetVariable("dni");
var average_bill = EzWebAPI.createRWGadgetVariable("average_bill");
var age = EzWebAPI.createRWGadgetVariable("age");
/*Temporary data for the demo*/
var users = [];
var user = ["Alejandro","Gonzalez Perez","07688357J","calle de Santa Engracia, 25, 1 B, Madrid","35.50","2"];
users["913933233"] = user;
user = ["Marta","Lopez Romero","34788114L","Marcelo Usera, 46, 28026 Madrid","40.74","1"];
users["915334432"] = user;
user = ["Rodrigo","Fernandez Bartolome","53333236P","calle de Gran Via, 25, Madrid","55.29","8"];
users["916432233"] = user;
user = ["Maria","Perez Casas","34788114L","Francisco Silvela, 105, 5 B, Madrid","66.15","3"];
users["917294723"] = user;
user = ["Juan","Perez Garcia","14798164L","Plaza de España, 1, 6 B, 28013 Madrid","166.22","5"];
users["983292929"] = user;
user = ["Alberto","Garcia Casas","34788114L","Camarena, 2, 4 A, 28047 Madrid","36.00","3"];
users["917744331"] = user;

function _phoneHandler(phone){
	if (phone!=null && phone!=undefined){

	  var info = document.createElement("div");
	  info.id = "div_info";

	  var title = document.createElement("p");
	  title.id="title";
	  title.appendChild(document.createTextNode("Tabla de Datos de Cliente"));
	  info.appendChild(title);
	  
	  var table = document.createElement("table");
	  var tbody = document.createElement("tbody");
	  table.appendChild(tbody);
	  info.appendChild(table);
	  
	  // THEADER
	  var tr = tbody.insertRow(-1);
	  var td = tr.insertCell(-1);
	  td.className="header";
	  td.appendChild(document.createTextNode("Datos del Usuario"));
	  
	  td = tr.insertCell(-1);
	  td.className="header";
	  td.appendChild(document.createTextNode("Valor"));
	  
	  // CLIENT INFO
	  // First Name
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("Nombre"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][0]));

	  // Last Name
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("Apellidos"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][1]));
	  
	  // DNI
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("DNI"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][2]));

	  // Address
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("Dirección"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][3]));
	  
	  // Average Bill
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("Factura Media"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][4]));

	  // Age
	  tr = tbody.insertRow(-1);
	  td = tr.insertCell(-1);
	  td.className="moreInfo";
	  td.appendChild(document.createTextNode("Antigüedad"));
	  
	  td = tr.insertCell(-1);
	  td.appendChild(document.createTextNode(users[phone][5]));
	  	  	  	  
		if(document.getElementById("info")){
				document.getElementById("info").innerHTML="";
        document.getElementById("info").appendChild(info);
				firstname.set(users[phone][0]);
				surname.set(users[phone][1]);
        dni.set(users[phone][2]);
        address.set(users[phone][3]);
        average_bill.set(users[phone][4]);        
        age.set(users[phone][5]);                
			}
	}
}

</script>
</head>
<body>
<div id='info'><i>A la espera de seleccionar una averia...</i></div>
</body>
</html>
